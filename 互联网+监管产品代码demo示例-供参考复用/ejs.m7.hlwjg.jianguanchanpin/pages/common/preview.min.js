"use strict";var preview=window.preview||function(e,n){return e.openPreviewUrl=function(e){var n=function(){return new Promise(function(e,n){ejs.storage.getItem({key:["no-filepreview-format"],success:function(n){var o=n["no-filepreview-format"]||"";e(o)},error:function(e){n()}})})};e={url:e.url||"default url",data:e.data||{},successCB:e.successCB||function(){},errorCB:e.errorCB||function(){},isDebug:e.isDebug||!1,fileName:e.fileName||""};var o=e.fileName,r=o.substring(o.lastIndexOf(".")+1,o.length);n().then(function(n){"-1"==n.indexOf(r)||""==o?ejs.util.getPreviewUrl({success:function(n){var r=/\w{8}-\w{4}-\w{4}-\w{4}-\w{8}/.exec(e.url),i="";i=r?n.previewUrl+e.url+"&fname="+o+"&uuid="+r:n.previewUrl+e.url,e.isDebug&&ejs.ui.showDebugDialog(i),ejs.page.open({pageUrl:i,pageStyle:1,orientation:1,data:e.data,success:function(n){e.successCB&&e.successCB(n)}})},error:function(n){e.errorCB&&e.errorCB(n)}}):preview.downloadFile({url:e.url,fileName:e.fileName,reDownloaded:1},function(){ejs.ui.toast("文件下载完成")})})["catch"](function(e){console.log("捕捉错误信息："+e)})},e.downloadFile=function(e,n){e.isBackground=e.isBackground||"1",e.openAfterComplete=e.openAfterComplete||"1","1"==e.isBackground&&ejs.ui.showWaiting("努力下载中..."),ejs.io.downloadFile({url:e.url,fileName:e.fileName,isBackground:e.isBackground,reDownloaded:e.reDownloaded||"1",openAfterComplete:e.openAfterComplete,success:function(o){"1"==e.isBackground&&ejs.ui.closeWaiting(),"1"!=e.openAfterComplete&&n&&"function"==typeof n&&n(o)},error:function(e){ejs.ui.toast("下载错误"+JSON.stringify(e))}})},"undefined"!=typeof module&&module.exports?module.exports=e:"function"==typeof define&&(define.amd||define.cmd)&&define(function(){return e}),e}({});