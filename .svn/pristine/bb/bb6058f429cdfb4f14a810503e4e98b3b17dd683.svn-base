!function(){"use strict";var t=['<div class="ui-datepicker-header">','    <a href="javascript:void(0);" class="ui-datepicker-btn ui-datepicker-prev-btn" data-type="leftbtn">&lt;</a>','    <a href="javascript:void(0);" class="ui-datepicker-btn ui-datepicker-next-btn" data-type="rightbtn">&gt;</a>','    <span class="ui-datepicker-curr-month" data-title="date"></span>',"</div>",'<div class="ui-datepicker-body">',"    <table>","        <thead>","            <tr>","                <th>一</th>","                <th>二</th>","                <th>三</th>","                <th>四</th>","                <th>五</th>","                <th>六</th>","                <th>日</th>","            </tr>","        </thead>",'        <tbody data-body="body"></tbody>',"    </table>","</div>"].join("");function e(t){if(!t.el)throw new Error("请传入正确的容器元素");this.el=this.getHTMLElement(t.el),this.cls=t.cls||"",this.loadTpl(),this.showDateEl=this.getHTMLElement("[data-title=date]"),this.tableBodyEl=this.getHTMLElement("[data-body=body]"),this.leftBtnEl=this.getHTMLElement("[data-type=leftbtn]"),this.rightBtnEl=this.getHTMLElement("[data-type=rightbtn]"),this.itemClick="function"==typeof t.itemClick?t.itemClick:function(){},this._addEvent()}e.prototype={createCalendar:function(t,e,a){var n=this.getNowDay();t=t||n.getFullYear(),a=a||n.getDate(),void 0===e?e=n.getMonth():--e<0?e=11:11<e&&(e=0);var i=new Date(t,e,1),r=i.getFullYear(),l=i.getMonth()+1,d=i.getDay(),s=new Date(t,e,0),h=s.getFullYear(),o=s.getMonth()+1,c=s.getDate(),y=new Date(t,e+1,0).getDate(),u=new Date(t,e+1,1),g=u.getFullYear(),p=u.getMonth()+1;if(y<a)throw new Error("当前传入天数，超出本月应有天数，本月只有："+y+"天");0===d&&(d=7);for(var f=d-1,m=[],v=0,b=0,E=0,T="",C="",D=0,w=0;w<42;w++)(D=w-f)<0&&(v=h,b=o,E=c+D+1,T="exceed"),0<=D&&D<y&&(v=r,b=l,E=D+1,T=""),y<=D&&(v=g,b=p,E=D-y+1,T="exceed"),C=b===l&&v===r&&E===a?this.cls:"",m.push({year:v,month:b,day:E,cls:T,dayCls:C});this.showDateEl.innerHTML=r+"-"+this.appendZero(l),this.year=r,this.month=l,this.day=a,this._renderCalendar(m)},_renderCalendar:function(t){for(var e="",a=1,n=t.length;a<=n;a++){var i=t[a-1];e+=1===a?'<tr><td class="'+i.cls+" "+i.dayCls+'" data-year="'+i.year+'" data-month="'+i.month+'">'+i.day+"</td>":a%7==0?'<td class="'+i.cls+" "+i.dayCls+'" data-year="'+i.year+'" data-month="'+i.month+'">'+i.day+"</td></tr><tr>":'<td class="'+i.cls+" "+i.dayCls+'" data-year="'+i.year+'" data-month="'+i.month+'">'+i.day+"</td>"}this.tableBodyEl.innerHTML=e},getCalendarData:function(){return{year:this.year.toString(),month:this.month.toString(),day:this.day.toString()}},_addEvent:function(){var t=this._handleTriggerDate.bind(this),l=this,d=this.cls;this.leftBtnEl.addEventListener("tap",function(){t(this,"-")}),this.rightBtnEl.addEventListener("tap",function(){t(this,"+")}),this.tableBodyEl.addEventListener("tap",function(t){var e,a,n,i=t.target,r=l.month;"TD"===i.tagName&&(d&&(i.classList.add(d),l.removeSiblingsCls(i,d)),e=i.dataset.year,a=i.dataset.month,n=i.innerHTML,l.itemClick.call(i,{year:e,month:a,day:i.innerHTML}),(r<a||a<r)&&l.createCalendar(e,a,parseInt(n,10)))})},removeSiblingsCls:function(a,n){[].slice.call(this.tableBodyEl.querySelectorAll("td")).forEach(function(t,e){t!==a&&t.classList.remove(n)})},_handleTriggerDate:function(t,e){var a=this.month,n=this.year,i=t.style;i.paddingTop="1px",setTimeout(function(){i.paddingTop=0},100),"+"===e?a++:"-"===e&&a--,a<=0?n--:12<a&&n++,this.createCalendar(n,a)},appendZero:function(t){return t<10?"0"+t:t},showCalendar:function(){this.el.style.display="block"},hideCalendar:function(){this.el.style.display="none"},toggleCalendar:function(){var t=this.el.style;"none"===t.display?t.display="block":t.display="none"},getNowDay:function(){return new Date},loadTpl:function(){this.el.innerHTML=t},getHTMLElement:function(t){var e=this.el&&1===this.el.nodeType?this.el:document;return 1!==t.nodeType?e.querySelector(t):t}},window.EasyCalendar=e}();