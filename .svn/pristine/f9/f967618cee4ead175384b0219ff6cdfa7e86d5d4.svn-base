"use strict";Util.loadJs(["js/widgets/baidumap/baidumap.js","pages/common/common.js"],function(){customBiz.configReady()});var customBiz={configReady:function(){Config.configReady(null,function(){customBiz.initListeners(),customBiz.location()},function(e){})},initListeners:function(){var e=this;ejs.device.setBounce({isEnable:0,success:function(e){},error:function(e){}}),mui(".mui-scroll-wrapper").scroll({scrollY:!0,scrollX:!1,startX:0,startY:0,indicators:!0,deceleration:6e-4,bounce:!1}),mui("#listdata").on("tap","li",function(){Zepto(this).addClass("em-righticon-active").siblings().removeClass("em-righticon-active");var i=this.querySelector(".em-left p").innerText.trim(),t=this.querySelector(".em-left span").innerText.trim();console.log(i+t);var n=i+t;ejs.ui.confirm({title:"位置",message:n,buttonLabels:["取消","签到"],cancelable:1,success:function(i){"1"==i.which&&e.sign(n)}})})},location:function(){Util.ejs.ui.showWaiting("加载中...");var e=new BaiduMap({container:"#baidumap",isForceDD:!1,isForceEJS:!0,success:function(i){e.searchHotPoint({poiRadius:12500,numPois:12,success:function(e){Util.ejs.ui.closeWaiting();var i=e,t=document.querySelector("#template").innerHTML,n="";mui.each(i,function(e,i){n+=Mustache.render(t,i)}),document.querySelector("#listdata").innerHTML=n}})},error:function(e){Util.ejs.ui.closeWaiting(),document.querySelector(".em-wifi").style.display="block",ejs.runtime.getEjsVersion({success:function(i){i.version<="3.1.5"?ejs.ui.toast(e):ejs.device.checkPermissions({permissionsType:0,success:function(e){0==e.permissionGranted?ejs.ui.alert({title:"提示",message:Util.os.android?"请前往设置允许程序定位权限":"请确保开启定位服务并且允许程序定位权限",buttonName:"确定",cancelable:1,success:function(e){ejs.runtime.openSetting()},error:function(e){}}):1==e.permissionGranted&&ejs.ui.alert({title:"提示",message:"请确保开启定位服务且允许APP定位权限，仍然无效请重启手机再次尝试",buttonName:"确定",cancelable:1,success:function(e){ejs.runtime.openSetting()},error:function(e){}})},error:function(e){}})},error:function(e){}})}});document.querySelector(".em-reposition").addEventListener("tap",function(){e.update()}),document.querySelector(".em-wifi").addEventListener("click",function(){ejs.page.reload()})},sign:function(e){var i=ejs.os.android?"android":"ios",t={place:e,origin:i};common.ajax({url:"kaoqin_sign_v7",data:t,isShowWaiting:!1},function(e){"1"==e.status.code?(ejs.ui.toast("签到成功！"),ejs.page.close({resultData:{key1:"value1"}})):ejs.ui.alert({title:"提示",message:e.status.text,buttonName:"确定",cancelable:1,success:function(e){ejs.page.close({resultData:{key1:"value1"}})},error:function(e){}})},function(e){ejs.ui.toast(Config.TIPS_II)},{isDebug:!0})}};