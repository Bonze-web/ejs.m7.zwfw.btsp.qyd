!function(e,s){"use strict";var t={container:"#amap",map:{resizeEnable:!0},geolocation:{enableHighAccuracy:!0,timeout:1e4,buttonOffset:new e.Pixel(10,20),zoomToAccuracy:!0,buttonPosition:"RB"},radius:1e3};function o(o){if(!o.container)throw new Error("请传入地图容器元素");window._addrFrameCallback=this._addrFrameCallback.bind(this),o.container=this.getHTMLElement(o.container),this.extend(o,t),this.toast=Util.ejs.ui.toast,this.options=o,this._initializationGeo(o)}o.prototype={_initializationGeo:function(o){var t,n=this,i=new e.Map(o.container,o.map);i.plugin("AMap.Geolocation",function(){t=new e.Geolocation(o.geolocation),i.addControl(t),t.getCurrentPosition(),e.event.addListener(t,"complete",n._onComplete.bind(n)),e.event.addListener(t,"error",n._onError.bind(n))})},_onComplete:function(o){this.position=o.position,this._coordConvert(this.position),o.position=this.position,this.options.onComplete&&this.options.onComplete.call(this,o)},_onError:function(o){this.toast("定位失败"),this.options.onError&&this.options.onError.call(this,o)},_coordConvert:function(n){var o=n.lng,t=n.lat,i=new s.Point(o,t),e=new s.Convertor,a=[],r=this;a.push(i),e.translate(a,3,5,function(o){var t=o.points[0];n.lng=t.lng,n.lat=t.lat,r.searchQuery(n.lng,n.lat)})},searchQuery:function(o,t){var n=document.createElement("script");n.src="http://api.map.baidu.com/geocoder/v2/?callback=_addrFrameCallback&location="+t+","+o+"&output=json&pois=1&ak=K5LXDCfHLnGvLDQsZx0AKyXNV5kLObYF&radius="+this.options.radius,document.body.appendChild(n)},_addrFrameCallback:function(o){this.options.poiCallback&&this.options.poiCallback.call(this,o.result||{})},getHTMLElement:function(o){return o?"string"==typeof o?document.querySelector(o):o:""},extend:function(){for(var o=[].slice.call(arguments),t=o[0],n=1,i=o.length;n<i;n++){var e=o[n];for(var a in e)void 0===t[a]&&(t[a]=e[a])}}},window.AMAP=o}(window.AMap,window.BMap);